(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{206:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),n("p",[t._v("我还发了一个npm包:"),n("a",{attrs:{href:"https://github.com/OBKoro1/notification-Koro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("notification-Koro1"),n("OutboundLink")],1),t._v("，非常轻量简洁，觉得不错的话，点个Star吧~")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),n("blockquote",[n("p",[n("a",{attrs:{href:"http://obkoro1.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("博客"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://obkoro1.com/web_accumulate/accumulate/",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端积累文档"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://github.com/OBKoro1/articleImg_src/blob/master/juejin/1631b6f52f7e7015.jpeg?raw=true",target:"_blank",rel:"noopener noreferrer"}},[t._v("公众号"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://github.com/OBKoro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),n("OutboundLink")],1)])]),t._v(" "),t._m(11),t._v(" "),n("p",[t._v("API的具体细节，等下再说，先试试这个API~")]),t._v(" "),t._m(12),t._v(" "),t._m(13),n("hr"),t._v(" "),t._m(14),t._v(" "),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/notification#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN"),n("OutboundLink")],1),t._v("：目前"),n("code",[t._v("Notification")]),t._v("除了IE浏览器不支持外, 其他浏览器都已支持桌面通知，移动端浏览器基本都未支持。")]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),n("p",[t._v("为了避免网站滥用通知扰民，在向用户显示通知之前，需要经过用户同意。")]),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._m(30),t._v(" "),t._m(31),t._v(" "),n("ul",[n("li",[t._v("title：通知的标题")]),t._v(" "),n("li",[t._v("options：通知的设置选项（可选）。\n"),n("ul",[n("li",[t._v("body：字符串。通知的body内容。")]),t._v(" "),t._m(32),t._v(" "),n("li",[t._v("icon：字符串。要在通知中显示的图标的URL。")]),t._v(" "),t._m(33),t._v(" "),n("li",[t._v("renotify: 布尔值。相同tag，新通知出现的时候是否替换之前的(开启此项，tag必须设置)。")]),t._v(" "),n("li",[t._v("requireInteraction：布尔值。通知不自动关闭，默认为false(自动关闭)。")]),t._v(" "),n("li",[t._v("还有一些不太重要的配置可以看"),n("a",{attrs:{href:"https://www.zhangxinxu.com/wordpress/2016/07/know-html5-web-notification/",target:"_blank",rel:"noopener noreferrer"}},[t._v("张鑫旭老师的博客"),n("OutboundLink")],1),t._v("和"),n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/notification",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN"),n("OutboundLink")],1),t._v("的介绍")])])])]),t._v(" "),t._m(34),t._v(" "),n("p",[t._v("默认值为false，通知会在三四秒之后自动关闭。")]),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),n("p",[t._v("这种情况显然，我们只能默认操作最后一个通知，除非你把每个通知返回的实例都保存下来。")]),t._v(" "),n("p",[t._v("我发布的npm包："),n("a",{attrs:{href:"https://github.com/OBKoro1/notification-Koro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("notification-koro1"),n("OutboundLink")],1),t._v("，可以"),n("strong",[t._v("自定义一定的时间间隔自动关闭不自动关闭的通知，也可以一次性关闭所有通知")])]),t._v(" "),n("p",[t._v("PS：如果没有触发叠加，很可能是因为你两次通知的tag配置项是相同的(相同tag只能出现一个弹窗)。")]),t._v(" "),n("p",[t._v("PS:  safari下不支持该选项,默认自动关闭")]),t._v(" "),t._m(37),t._v(" "),n("p",[t._v("默认值为false，chorme下相同tag的通知不替换，还是老的通知")]),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),n("p",[t._v("PS： safari下不支持该选项，默认两个相同tag的通知，新通知替换之前旧的通知。")]),t._v(" "),t._m(40),t._v(" "),n("p",[t._v("生成通知，会返回一个实例，如下：")]),t._v(" "),t._m(41),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),n("p",[t._v("PS： 这些属性都是只读的，不能删除，不能修改，不能遍历。")]),t._v(" "),t._m(47),t._v(" "),n("p",[t._v("我们可以使用通知的实例来监听通知的事件：")]),t._v(" "),t._m(48),t._v(" "),t._m(49),t._m(50),t._v(" "),n("p",[t._v("例如：用定时器5秒后才监听通知的点击和显示事件，则永远不会触发通知显示的回调，点击事件在5秒后才可以正常起作用但会错误五秒之前用户的点击。")]),t._v(" "),t._m(51),t._v(" "),t._m(52),n("p",[t._v("没有设置不自动关闭的话，chrome通知将会在4.5秒左右自动关闭通知，safari则是5秒钟(无法设置不自动关闭)。")]),t._v(" "),n("p",[t._v("notification没有定时控制通知多久后消失的功能，当出现多个通知，也无法统一关闭。")]),t._v(" "),n("p",[t._v("这两个问题，在我发布的NPM包："),n("a",{attrs:{href:"https://github.com/OBKoro1/notification-Koro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("notification-koro1"),n("OutboundLink")],1),t._v("中，都解决掉了，并提供更清晰的回调")]),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),n("p",[t._v("这里是一些API/浏览器细节，以及可能会遇到的问题，可以先不看，等真正遇到了，回头再来看。")]),t._v(" "),t._m(56),t._v(" "),n("p",[t._v("一旦用户禁止网站显示通知，网站就不能再请求用户授权显示通知，需要用户去设置中更改。")]),t._v(" "),n("p",[t._v("chrome浏览器的通知设置位置：设置>高级>内容设置>通知")]),t._v(" "),n("p",[t._v("saafari浏览器：偏好设置>网站>通知>找到网站>修改权限/恢复默认")]),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),n("p",[t._v("在safari浏览器下，没有关闭请求权限的选项，用户必须选择同意/拒绝。")]),t._v(" "),t._m(59),t._v(" "),n("p",[t._v("可能是网站进行了同源限制(比如github)，不是域名下面的图片，会报错，不能调用。")]),t._v(" "),t._m(60),t._v(" "),t._m(61),t._v(" "),t._m(62),t._v(" "),n("p",[t._v("在safari下面，同一个网站(比如谷歌)，同样的代码，chorme可以正常显示icon，safari却没有icon，也没有报错。")]),t._v(" "),n("p",[t._v("谷歌之后发现,在"),n("a",{attrs:{href:"https://stackoverflow.com/questions/20949203/i-dont-see-the-icon-in-my-web-notification-in-safari",target:"_blank",rel:"noopener noreferrer"}},[t._v("stack overflow"),n("OutboundLink")],1),t._v("里面看到"),n("strong",[t._v("safari只支持body和tag选项,并不支持icon选项")]),t._v("。")]),t._v(" "),t._m(63),t._v(" "),t._m(64),t._v(" "),t._m(65),t._v(" "),t._m(66),t._v(" "),t._m(67),t._v(" "),n("p",[t._v("试一下"),n("a",{attrs:{href:"https://github.com/OBKoro1/notification-Koro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("notification-Koro1"),n("OutboundLink")],1),t._v("啦, 持续维护，简单方便~")]),t._v(" "),n("hr"),t._v(" "),t._m(68),t._v(" "),n("p",[t._v("本文写的比较细，可以先mark一下，然后以后真正用到这个API了，可以先通过文中的栗子，然后再查找对应的内容。")]),t._v(" "),n("p",[t._v("还有就是注意浏览器间的差异，我自己就试了chrome和safari，然后这两个浏览器在实现细节上有很多不一样的地方，开发的时候注意一下。")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://obkoro1.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("博客"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://obkoro1.com/web_accumulate/accumulate/",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端积累文档"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://github.com/OBKoro1/articleImg_src/blob/master/juejin/1631b6f52f7e7015.jpeg?raw=true",target:"_blank",rel:"noopener noreferrer"}},[t._v("公众号"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://github.com/OBKoro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("参考资料：")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/OBKoro1/notification-Koro1",target:"_blank",rel:"noopener noreferrer"}},[t._v("notification-Koro1"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.zhangxinxu.com/wordpress/2016/07/know-html5-web-notification/",target:"_blank",rel:"noopener noreferrer"}},[t._v("简单了解HTML5中的Web Notification桌面通知"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/notification",target:"_blank",rel:"noopener noreferrer"}},[t._v("Notification MDN"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/59ed37f5f265da431e15eaac",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML5 桌面通知：Notification API"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"点个star支持我一下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#点个star支持我一下"}},[t._v("#")]),t._v(" 点个"),n("a",{attrs:{href:"https://github.com/OBKoro1/web_accumulate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Star"),n("OutboundLink")],1),t._v("支持我一下~")]),t._v(" "),n("comment-comment")],1)}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"h5-notification浏览器桌面通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#h5-notification浏览器桌面通知"}},[this._v("#")]),this._v(" H5 notification浏览器桌面通知")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://github.com/OBKoro1/articleImg_src/blob/master/weibo_img_move/005Y4rCogy1g0brdnk332j30xc0dwjtz.jpg?raw=true",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("Notification")]),this._v("是HTML5新增的API，用于向用户配置和显示桌面通知。上次在别的网站上看到别人的通知弹窗，好奇之余也想知道如何实现的。实际去查一下发现并不复杂，且可以说比较简单，故写篇博客分享给大家,希望能帮你们了解这个API。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"npm包："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#npm包："}},[this._v("#")]),this._v(" npm包：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"chrome下notification的表现："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chrome下notification的表现："}},[this._v("#")]),this._v(" chrome下"),s("code",[this._v("Notification")]),this._v("的表现：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("以谷歌为例，一开始需要用户允许通知：")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://github.com/OBKoro1/articleImg_src/blob/master/weibo_img_move/005Y4rCogy1fzskpfbfmbj30hs078q36.jpg?raw=true",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[this._v("允许通知之后，显示的通知长这样：")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://github.com/OBKoro1/articleImg_src/blob/master/weibo_img_move/005Y4rCogy1fzyaxnnc25j30kg03wjrs.jpg?raw=true",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"notification特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notification特性"}},[this._v("#")]),this._v(" "),s("code",[this._v("Notification")]),this._v("特性")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[s("p",[s("strong",[this._v("该通知是脱离浏览器的，即使用户没有停留在当前标签页，甚至最小化了浏览器，也会在主屏幕的右上角显示通知，然后在一段时间后消失")]),this._v("。")])]),this._v(" "),s("li",[s("p",[s("strong",[this._v("我们可以监听通知的显示，点击，关闭等事件")]),this._v(",比如点击通知打开一个页面。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"栗子：去各个网站里面的控制台去运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#栗子：去各个网站里面的控制台去运行"}},[this._v("#")]),this._v(" 栗子：去各个网站里面的控制台去运行")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面是一个简单的栗子，大家"),s("strong",[this._v("可以先在各个网站的控制台里面运行查看"),s("code",[this._v("Notification")]),this._v("的效果")]),this._v("：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auto"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 文字方向")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("body")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"通知：OBKoro1评论了你的朋友圈"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通知主体")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("requireInteraction")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不自动关闭通知")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通知图标 ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("icon")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://upload-images.jianshu.io/upload_images/5245297-818e624b75271127.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("notifyMe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这是通知的标题'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("notifyMe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 先检查浏览器是否支持")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'浏览器不支持通知'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 检查用户曾经是否同意接受通知")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'granted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" notification "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 显示通知")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用户还未选择，可以询问用户是否同意发送通知")]),t._v("\n      Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestPermission")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("permission")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'granted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户同意授权'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" notification "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 显示通知")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户关闭授权 未刷新页面之前 可以再次请求授权'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// denied")]),t._v("\n          console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户拒绝授权 不能显示通知'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// denied 用户拒绝")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户曾经拒绝显示通知'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"浏览器支持："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器支持："}},[this._v("#")]),this._v(" 浏览器支持：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("因为兼容性问题，所以在使用"),s("code",[this._v("Notification")]),this._v("之前，我们需要查看浏览器是否支持"),s("code",[this._v("Notification")]),this._v("这个API：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 桌面通知的逻辑")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"通知权限："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通知权限："}},[this._v("#")]),this._v(" 通知权限：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("Notification.permission")]),this._v(" "),s("strong",[this._v("用于表明当前通知显示的授权状态")]),this._v(",它有三个值：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ol",[n("li",[n("code",[t._v("default")]),t._v(": 默认值，用户还未选择")]),t._v(" "),n("li",[n("code",[t._v("granted")]),t._v(": 用户允许该网站发送通知")]),t._v(" "),n("li",[n("code",[t._v("denied")]),t._v(": 用户拒绝该网站发送通知")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"检测权限："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检测权限："}},[this._v("#")]),this._v(" 检测权限：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("检测浏览器是否支持"),s("code",[this._v("Notification")]),this._v("之后，需要检测一下用户通知权限。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'granted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户曾经同意授权'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 随时可以显示通知")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户还未选择同意/拒绝'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下一步请求用户授权")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户曾经拒绝授权 不能显示通知'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"请求权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#请求权限"}},[this._v("#")]),this._v(" 请求权限")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当"),s("code",[this._v("Notification.permission")]),this._v("为"),s("code",[this._v("default")]),this._v("的时候，我们需要使用"),s("code",[this._v("Notification.requestPermission()")]),this._v("来请求用户权限。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("Notification.requestPermission()")]),this._v("基于promise语法，then的回调函数参数是用户权限的状态"),s("code",[this._v("Notification.permission")]),this._v("的值。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Notification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestPermission")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("permission")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'granted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户同意授权'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 随时可以显示通知")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("permission "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户关闭授权 可以再次请求授权'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户拒绝授权 不能显示通知'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 老版本使用的是回调函数机制：Notification.requestPermission(callback); 参数一样")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"推送通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#推送通知"}},[this._v("#")]),this._v(" 推送通知")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当"),s("code",[this._v("Notification.permission")]),this._v("为"),s("code",[this._v("granted")]),this._v("时，请求到用户权限之后，不必立即发送通知，可以在任意时刻，以任意形式来发送通知。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 传空配置")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" title "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这里是标题'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" notification "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 显示通知")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("上面这段代码就可以显示一个简单的通知了，只要用户允许你弹窗。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"notification的参数："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notification的参数："}},[this._v("#")]),this._v(" "),s("code",[this._v("Notification")]),this._v("的参数：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("tag：代表通知的一个识别标签，"),s("strong",[this._v("相同tag时只会打开一个通知窗口")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("data：想要和通知关联的数据,可以在"),s("code",[this._v("new Notification")]),this._v("返回的实例中找到。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("requireInteraction")]),this._v(": 保持通知不自动关闭")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当设置为"),s("code",[this._v("true")]),this._v(",并且当有超过两个通知("),s("code",[this._v("new Notification(title, options)")]),this._v(")时，会出现如下图的通知叠加状态。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://github.com/OBKoro1/articleImg_src/blob/master/weibo_img_move/005Y4rCogy1fzyy3ykl2gj30jy0kc772.jpg?raw=true",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("renotify")]),this._v("：相同")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("设置为"),s("code",[this._v("true")]),this._v(", 两个相同tag的通知，新通知替换之前旧的通知。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[n("strong",[t._v("注意")]),t._v("：使用"),n("code",[t._v("renotify")]),t._v("，"),n("strong",[t._v("必须要同时设置"),n("code",[t._v("tag")]),t._v("选项，否则将会报错")]),t._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"notification的实例："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notification的实例："}},[this._v("#")]),this._v(" "),s("code",[this._v("Notification")]),this._v("的实例：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" instanceNotification "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Notification")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("instanceNotification")]),this._v("就是当前通知的实例，在该实例上，我们可以"),s("strong",[this._v("查询该通知的配置，监听事件，调用实例方法")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下文都以"),s("code",[this._v("instanceNotification")]),this._v("指代通知返回的实例。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"通知的配置："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通知的配置："}},[this._v("#")]),this._v(" 通知的配置：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("在通知实例上可以读取到设置通知时的所有配置")]),this._v("，比如：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("通知标题："),s("code",[this._v("instanceNotification. title")]),this._v("、通知内容："),s("code",[this._v("instanceNotification. body")]),this._v("、通知图标："),s("code",[this._v("instanceNotification. icon")]),this._v("等。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"事件处理："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件处理："}},[this._v("#")]),this._v(" 事件处理：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[n("code",[t._v("click")]),t._v(": 用户点击通知时被触发")]),t._v(" "),n("li",[n("code",[t._v("show")]),t._v(": 通知显示的时候被触发")]),t._v(" "),n("li",[n("code",[t._v("error")]),t._v(": 通知遇到错误时被触发")]),t._v(" "),n("li",[n("code",[t._v("close")]),t._v(": 用户关闭通知时被触发")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("instanceNotification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something 可以是：打开网址，发请求，关闭通知等")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("注意")]),this._v("：最好是一发出通知就立即监听事件，否则有些事件可能一开始没被触发或永远不会触发。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"关闭通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭通知"}},[this._v("#")]),this._v(" 关闭通知")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("instanceNotification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[this._v("#")]),this._v(" 应用场景")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("即时通讯软件(邮件、聊天室)")]),this._v(" "),s("li",[this._v("体育赛事结果彩票/抽奖结果")]),this._v(" "),s("li",[this._v("新闻网站重大新闻通知")]),this._v(" "),s("li",[this._v("网站的重大更新，重大新闻等。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"notification其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notification其他"}},[this._v("#")]),this._v(" notification其他")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"用户拒绝显示通知："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户拒绝显示通知："}},[this._v("#")]),this._v(" 用户拒绝显示通知：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"关闭请求权限："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭请求权限："}},[this._v("#")]),this._v(" 关闭请求权限：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在chorme浏览器中：当用户关闭请求权限的弹窗(右上角的叉叉)，页面还没刷新，我们可以再次向用户请求权限。"),s("strong",[this._v("页面刷新过后，浏览器默认用户拒绝")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"icon不显示问题："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#icon不显示问题："}},[this._v("#")]),this._v(" icon不显示问题：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"tag："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tag："}},[this._v("#")]),this._v(" tag：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ol",[n("li",[n("code",[t._v("tag")]),t._v("相同的通知，同时只能出现一个，老通知是否会被覆盖取决于："),n("code",[t._v("renotify")]),t._v("配置和浏览器。")]),t._v(" "),n("li",[t._v("chrome下：当通知关闭之后，"),n("strong",[t._v("上次出现过的tag在一段时间内，不能再出现")]),t._v("，比如刷新页面再请求相同tag的通知。（在safari下正常出现）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"safari下面不能显示icon"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#safari下面不能显示icon"}},[this._v("#")]),this._v(" safari下面不能显示icon")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"连续触发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连续触发"}},[this._v("#")]),this._v(" 连续触发")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在safari和chrome下短时间内连续触发通知(不设"),s("code",[this._v("tag")]),this._v("，不设"),s("code",[this._v("requireInteraction")]),this._v(")，会出现如下表现：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://github.com/OBKoro1/articleImg_src/blob/master/weibo_img_move/005Y4rCogy1g05d2z0zxej30je03wwep.jpg?raw=true",alt:"notification 连续触发"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这个表现，"),s("strong",[this._v("通知没有icon、标题、内容，就显得没有意义了")]),this._v("，浏览器以这种形式，限制开发者不要频繁打扰用户。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"notification-koro1："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notification-koro1："}},[this._v("#")]),this._v(" notification-Koro1：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"结语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[this._v("#")]),this._v(" 结语")])}],!1,null,null,null);s.default=e.exports}}]);