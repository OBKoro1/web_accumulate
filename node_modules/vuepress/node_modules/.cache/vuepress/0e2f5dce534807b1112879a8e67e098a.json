{"remainingRequest":"/Users/koro/work/web_my/web_accumulate/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/koro/work/web_my/web_accumulate/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/koro/work/web_my/web_accumulate/docs/accumulate/tool/博客外链失效一键替换.md?vue&type=template&id=223d43d6&","dependencies":[{"path":"/Users/koro/work/web_my/web_accumulate/docs/accumulate/tool/博客外链失效一键替换.md","mtime":1575791421492},{"path":"/Users/koro/work/web_my/web_accumulate/node_modules/cache-loader/dist/cjs.js","mtime":1557296864520},{"path":"/Users/koro/work/web_my/web_accumulate/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1557296867191},{"path":"/Users/koro/work/web_my/web_accumulate/node_modules/cache-loader/dist/cjs.js","mtime":1557296864520},{"path":"/Users/koro/work/web_my/web_accumulate/node_modules/vue-loader/lib/index.js","mtime":1557296867190},{"path":"/Users/koro/work/web_my/web_accumulate/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1557296867284}],"contextDependencies":[],"result":["\n<div class=\"content\"><h2 id=\"博客外链失效一键替换\"><a class=\"header-anchor\" href=\"#博客外链失效一键替换\" aria-hidden=\"true\">#</a> 博客外链失效一键替换</h2>\n<p>大约一个月前，微博的图片外链失效了，以及掘金因为盗链问题也于<code>2019/06/06</code><a href=\"https://juejin.im/post/5cefb6a3f265da1b95703b9d\" target=\"_blank\" rel=\"noopener noreferrer\">决定开启防盗链<OutboundLink/></a>，造成的影响是：<strong>个人博客网站的引用了这些图片外链都不能显示</strong>。</p>\n<p><strong>目前微博和掘金的屏蔽，在CSDN和segmentfault都是可以正常显示的，只影响个人博客</strong>。</p>\n<p>比如前段时间我的博客:<a href=\"http://obkoro1.com\" target=\"_blank\" rel=\"noopener noreferrer\">http://obkoro1.com<OutboundLink/></a>上引用的微博图片都不能显示了。</p>\n<p>因为我写博客比较频繁，被屏蔽的图片不在少数，肯定不能一个个手动的替换，查了一番没有找到现成的解决方案，做了个脚本工具，并且写了文档把它开源出来了。</p>\n<h2 id=\"markdown-img-down-site-change-下载-替换markdown中的图片\"><a class=\"header-anchor\" href=\"#markdown-img-down-site-change-下载-替换markdown中的图片\" aria-hidden=\"true\">#</a> markdown-img-down-site-change(下载/替换markdown中的图片)</h2>\n<blockquote>\n<p>搜索目标文件夹中的markdown文件，找到目标图片，提供下载图片，替换图片链接的功能-通常用于markdown 图片失效。</p>\n</blockquote>\n<h3 id=\"简介\"><a class=\"header-anchor\" href=\"#简介\" aria-hidden=\"true\">#</a> 简介</h3>\n<p>这是一个极为轻量的脚本，引用包，设置好参数，通过API即可轻松上手。</p>\n<h3 id=\"解决什么问题？\"><a class=\"header-anchor\" href=\"#解决什么问题？\" aria-hidden=\"true\">#</a> 解决什么问题？</h3>\n<ol>\n<li>集中下载markdown文件中某个域名下的图片到一个文件夹下。</li>\n<li>用新的图片链接替换markdown文件中某个域名的图片链接。</li>\n</ol>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token comment\">// 1. 下载这两个图片</span>\n<span class=\"token comment\">// ![](https://user-gold-cdn.xitu.io/2019/5/20/图片名字?w=2024&amp;h=1240&amp;f=png&amp;s=339262)</span>\n<span class=\"token comment\">// ![](https://user-gold-cdn.xitu.io/2018/6/16/图片名字)</span>\n<span class=\"token comment\">// 2. 替换成：github的链接</span>\n<span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>raw<span class=\"token punctuation\">.</span>githubusercontent<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>OBKoro1<span class=\"token operator\">/</span>articleImg_src<span class=\"token operator\">/</span>master<span class=\"token operator\">/</span>juejin<span class=\"token operator\">/</span>图片名字<span class=\"token operator\">?</span>w<span class=\"token operator\">=</span><span class=\"token number\">2024</span><span class=\"token operator\">&amp;</span>h<span class=\"token operator\">=</span><span class=\"token number\">1240</span><span class=\"token operator\">&amp;</span>f<span class=\"token operator\">=</span>png<span class=\"token operator\">&amp;</span>s<span class=\"token operator\">=</span><span class=\"token number\">339262</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>raw<span class=\"token punctuation\">.</span>githubusercontent<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>OBKoro1<span class=\"token operator\">/</span>articleImg_src<span class=\"token operator\">/</span>master<span class=\"token operator\">/</span>juejin<span class=\"token operator\">/</span>图片名字<span class=\"token punctuation\">)</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br></div><!--beforeend--></div><!--afterend--><h3 id=\"安装\"><a class=\"header-anchor\" href=\"#安装\" aria-hidden=\"true\">#</a> 安装:</h3>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code>npm i markdown<span class=\"token operator\">-</span>img<span class=\"token operator\">-</span>down<span class=\"token operator\">-</span>site<span class=\"token operator\">-</span>change <span class=\"token operator\">-</span><span class=\"token constant\">S</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br></div><!--beforeend--></div><!--afterend--><h3 id=\"文档：\"><a class=\"header-anchor\" href=\"#文档：\" aria-hidden=\"true\">#</a> 文档：</h3>\n<p><a href=\"https://github.com/OBKoro1/markdown-img-down-site-change\" target=\"_blank\" rel=\"noopener noreferrer\">Github<OutboundLink/></a></p>\n<p><a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/wiki/API\" target=\"_blank\" rel=\"noopener noreferrer\">API<OutboundLink/></a></p>\n<p><a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/wiki/%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97\" target=\"_blank\" rel=\"noopener noreferrer\">更新日志<OutboundLink/></a></p>\n<h3 id=\"数据安全：\"><a class=\"header-anchor\" href=\"#数据安全：\" aria-hidden=\"true\">#</a> 数据安全：</h3>\n<p>刚上手可能不了解脚本的功能，需要调试一番，这时候万一把<code>markdown</code>文件给改坏了，岂不是要哭死？</p>\n<p>脚本有两种形式来防止这种情况发生：</p>\n<ol>\n<li>脚本会<a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/wiki/API#copy_item_data%E5%A4%87%E4%BB%BD%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%9C%B0%E5%9D%80\" target=\"_blank\" rel=\"noopener noreferrer\">默认备份<OutboundLink/></a>你的文件。</li>\n<li>默认开启<a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/wiki/API#test%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF%E6%B5%8B%E8%AF%95%E6%A8%A1%E5%BC%8F\" target=\"_blank\" rel=\"noopener noreferrer\">测试模式<OutboundLink/></a>，等到调试的差不多了，可以关闭测试模式。</li>\n<li>建议：再不放心的话，可以先用一两个文件来测试一下脚本</li>\n</ol>\n<h3 id=\"使用：20行代码不到\"><a class=\"header-anchor\" href=\"#使用：20行代码不到\" aria-hidden=\"true\">#</a> 使用：20行代码不到</h3>\n<p>在项目中有一个使用<a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/blob/master/example.js\" target=\"_blank\" rel=\"noopener noreferrer\">栗子<OutboundLink/></a>，里面加了蛮多注释和空行的，实际代码20行都不到，可以说很简单了，如下：</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token comment\">// npm i markdown-img-down-site-change -S </span>\n<span class=\"token keyword\">const</span> markdownImageDown <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'markdown-img-down-site-change'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 文件模块</span>\n\n<span class=\"token comment\">// 传参： 这也是脚本的默认参数，根据情况可以自行修改</span>\n<span class=\"token keyword\">let</span> option <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    replace_image_url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://user-gold-cdn.xitu.io/'</span><span class=\"token punctuation\">,</span>\n    read_markdown_src<span class=\"token punctuation\">:</span> <span class=\"token string\">'./source'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 要查找markdown文件的文件夹地址</span>\n    down_img_src<span class=\"token punctuation\">:</span> <span class=\"token string\">'./juejin'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 下载图片到这个文件夹</span>\n    var_number<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span> <span class=\"token comment\">// url前半部分的变量数量 比如上面的日期: /2019/5/20/、/2018/6/16/</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 初始化</span>\n<span class=\"token keyword\">const</span> markdownImage <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">markdownImageDown</span><span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 下载外链</span>\nmarkdownImage<span class=\"token punctuation\">.</span><span class=\"token function\">checkDownImg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 上传下载下来的图片文件夹到云端 用户自己操作</span>\n\n<span class=\"token comment\">// 上传图片之后 </span>\n<span class=\"token comment\">// 脚本会把以前的外链替换成云端地址+拼接一个图片名</span>\nmarkdownImage<span class=\"token punctuation\">.</span><span class=\"token function\">updateOption</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    new_image_url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://xxx.com/目录地址/'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 图片上传的地址</span>\n    add_end<span class=\"token punctuation\">:</span> <span class=\"token string\">'?raw=true'</span> <span class=\"token comment\">// github图片地址有后缀 直接进去是仓库</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 替换外链 </span>\n<span class=\"token comment\">// 把replace_image_url的字符串换成new_image_url字符串</span>\nmarkdownImage<span class=\"token punctuation\">.</span><span class=\"token function\">replaceMarkdown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br><span class=\"line-number\">17</span><br><span class=\"line-number\">18</span><br><span class=\"line-number\">19</span><br><span class=\"line-number\">20</span><br><span class=\"line-number\">21</span><br><span class=\"line-number\">22</span><br><span class=\"line-number\">23</span><br><span class=\"line-number\">24</span><br><span class=\"line-number\">25</span><br><span class=\"line-number\">26</span><br><span class=\"line-number\">27</span><br><span class=\"line-number\">28</span><br><span class=\"line-number\">29</span><br></div><!--beforeend--></div><!--afterend--><h3 id=\"运行：\"><a class=\"header-anchor\" href=\"#运行：\" aria-hidden=\"true\">#</a> 运行：</h3>\n<p><strong>仔细阅读文本，配置好参数之后</strong></p>\n<p>在项目根节点新建一个<code>handleImg.js</code>文件，安装一下脚本，然后用<code>node</code>运行该文件：</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code>npm i markdown<span class=\"token operator\">-</span>img<span class=\"token operator\">-</span>down<span class=\"token operator\">-</span>site<span class=\"token operator\">-</span>change <span class=\"token operator\">-</span><span class=\"token constant\">S</span>\nnode handleImg<span class=\"token punctuation\">.</span>js\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br></div><!--beforeend--></div><!--afterend--><h3 id=\"功能-参数简介：\"><a class=\"header-anchor\" href=\"#功能-参数简介：\" aria-hidden=\"true\">#</a> 功能/参数简介：</h3>\n<ul>\n<li><code>checkDownImg()</code>： 下载查找到的图片</li>\n<li><code>replaceMarkdown()</code>: 替换图片链接为新的图片链接</li>\n<li><code>replace_image_url</code>：要替换的图片地址</li>\n<li><code>new_image_url</code>：图片的新地址</li>\n<li><code>test</code>: 测试模式。</li>\n<li><code>var_number</code>: 匹配图片链接的图片名之前的url，值为变量数量</li>\n<li><code>is_link</code>: 匹配链接。</li>\n<li><code>write_file_time</code>: 间隔多久修改markdown图片链接</li>\n<li><code>read_markdown_src</code>：要查找markdown文件的文件夹地址</li>\n<li><code>down_img_src</code>：下载图片到这个地址下</li>\n<li><code>copy_item_data</code>: 备份项目</li>\n<li><code>filter_item</code>: 过滤某些文件夹，不查找markdown。</li>\n<li><code>add_end</code>：在图片链接后面添加后缀添加后缀</li>\n</ul>\n<hr>\n<h2 id=\"欢迎试用\"><a class=\"header-anchor\" href=\"#欢迎试用\" aria-hidden=\"true\">#</a> 欢迎试用</h2>\n<p>有需要的小伙伴，赶紧来试试吧！文档写的很全，上手非常轻松，项目将会持续维护，有什么问题，欢迎给我提<a href=\"https://github.com/OBKoro1/markdown-img-down-site-change/issues\" target=\"_blank\" rel=\"noopener noreferrer\">issue<OutboundLink/></a>~</p>\n<p>如果觉得这个脚本还不错的话，就给<a href=\"https://github.com/OBKoro1/markdown-img-down-site-change\" target=\"_blank\" rel=\"noopener noreferrer\">项目<OutboundLink/></a>点个Star吧！</p>\n<p>以上2019.06.04\n<!-- 特殊字符串：用于修改/删除markdown的结尾提示语-OBKoro1 --></p>\n<h3 id=\"点个star支持我一下\"><a class=\"header-anchor\" href=\"#点个star支持我一下\" aria-hidden=\"true\">#</a> 点个<a href=\"https://github.com/OBKoro1/web_accumulate\" target=\"_blank\" rel=\"noopener noreferrer\">Star<OutboundLink/></a>支持我一下~</h3>\n<!-- '特殊字符串：用于删除编译后的issue组件-OBKoro1 -->\n<!-- more -->\n<comment-comment/>\n</div>\n",null]}