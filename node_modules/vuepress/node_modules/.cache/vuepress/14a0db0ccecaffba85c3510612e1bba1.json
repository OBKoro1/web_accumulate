{"remainingRequest":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/huangguobao/work/web_my/web_accumulate/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/huangguobao/work/web_my/web_accumulate/docs/accumulate/effect/时间差与时区转换.md?vue&type=template&id=5455ac9e&","dependencies":[{"path":"/Users/huangguobao/work/web_my/web_accumulate/docs/accumulate/effect/时间差与时区转换.md","mtime":1548245067215},{"path":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/cache-loader/dist/cjs.js","mtime":1548245069428},{"path":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1548245072336},{"path":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/cache-loader/dist/cjs.js","mtime":1548245069428},{"path":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/vue-loader/lib/index.js","mtime":1548245072335},{"path":"/Users/huangguobao/work/web_my/web_accumulate/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1548245072442}],"contextDependencies":[],"result":["\n<div class=\"content\"><h2 id=\"计算两个时间的时间差-时区转换\"><a class=\"header-anchor\" href=\"#计算两个时间的时间差-时区转换\" aria-hidden=\"true\">#</a> 计算两个时间的时间差&amp;时区转换</h2>\n<h3 id=\"计算两个时间的时间差：\"><a class=\"header-anchor\" href=\"#计算两个时间的时间差：\" aria-hidden=\"true\">#</a> 计算两个时间的时间差：</h3>\n<ol>\n<li>\n<p>获取两个时间数据，通常这两个时间是：后端给的时间数据和当前时间</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token string\">'2018/08/28 04:56:38'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 初始时间</span>\ndateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>dateBegin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Mon Aug 28 2017 04:56:38 GMT+0800 (中国标准时间)</span>\n<span class=\"token comment\">// 上面是Date对象的数据形式</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 第二个数据通常是当前时间</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div><!--beforeend--></div><!--afterend--></li>\n<li>\n<p>使用<code>getTime()</code>返回与固定的 1970 年 1 月 1 日的时间差，再用大的时间减去短的时间即可得出双方相差的毫秒数。</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> dateDiff <span class=\"token operator\">=</span> dateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> dateBegin<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br></div><!--beforeend--></div><!--afterend--></li>\n<li>\n<p>换算成你想要的时间单位，得出两个时间的时间差。</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token comment\">// 计算出相差天数</span>\n<span class=\"token keyword\">let</span> dayDiff <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>dateDiff <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 计算天数后剩余的毫秒数 利用这个时间去计算小时</span>\n<span class=\"token keyword\">let</span> leave1 <span class=\"token operator\">=</span> dateDiff <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 计算出小时数</span>\n<span class=\"token keyword\">let</span> hours <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>leave1 <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 计算相差分钟数</span>\n<span class=\"token keyword\">let</span> leave2 <span class=\"token operator\">=</span> leave1 <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 计算小时数后剩余的毫秒数</span>\n<span class=\"token keyword\">let</span> minutes <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>leave2 <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 计算相差分钟数</span>\n<span class=\"token comment\">// 计算相差秒数</span>\n<span class=\"token keyword\">let</span> leave3 <span class=\"token operator\">=</span> leave2 <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 计算分钟数后剩余的毫秒数</span>\n<span class=\"token keyword\">let</span> seconds <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>leave3 <span class=\"token operator\">/</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 结果</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`相差</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dayDiff<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">天</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hours<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">小时</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>minutes<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">分钟</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>seconds<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">秒`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br></div><!--beforeend--></div><!--afterend--></li>\n</ol>\n<p>如果你只想计算相差的小时数，不想管天数：</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> dayDiff <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>dateDiff <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 其他的同理，倍数正确即可</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br></div><!--beforeend--></div><!--afterend--><h3 id=\"时区转换\"><a class=\"header-anchor\" href=\"#时区转换\" aria-hidden=\"true\">#</a> 时区转换</h3>\n<p><strong>需求</strong>：</p>\n<p>拿到这么一串字符串：<code>2018-09-17</code>，要与当前的日期比较，求出日期差。</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> time <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`2018-09-17`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这一秒的时间 需重新设置</span>\ndateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">setHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 计算时间差 参照上文</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div><!--beforeend--></div><!--afterend--><p><strong>东八区的时间</strong>：</p>\n<p>上面<code>new Date(time)</code>之后拿到的是零时区 0 点的时间，在东八区也就是北京时间<code>08:00:00</code>。</p>\n<p>而我们第二个时间设置的是北京时间<code>00:00:00</code>，这里面就出现了八个小时的误差。</p>\n<p><strong>转换时区的三种方法</strong>：</p>\n<ol>\n<li>\n<p>设置世界时为当前时区的时间：</p>\n<p>设置具体的时间，传进<code>new Date()</code>的时候会自动转成北京时间<code>00:00:00</code>，然后两个时间就可以同步了。</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> time <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`2018-09-17`</span></span><span class=\"token punctuation\">;</span>\ntime <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>time<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> 00:00:00`</span></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 后面加上具体时间</span>\n<span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这一秒的时间 需重新设置</span>\ndateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">setHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 计算时间差 参照上文</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br></div><!--beforeend--></div><!--afterend--><p>也可以使用<code>setHours</code>：</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> time <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`2018-09-17`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndateBegin<span class=\"token punctuation\">.</span><span class=\"token function\">setHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// new Date()之后 设为0点 两个时间同步</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这一秒的时间 需重新设置</span>\ndateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">setHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 计算时间差 参照上文</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br></div><!--beforeend--></div><!--afterend--></li>\n<li>\n<p>当前时区与世界时同步：</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> time <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`2018-09-17`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这一秒的时间 需重新设置</span>\ndateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">setHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置为八点与世界时一致</span>\n<span class=\"token comment\">// 计算时间差 参照上文</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div><!--beforeend--></div><!--afterend--></li>\n<li>\n<p>你可能不知道当前时区与世界时相差多少</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">let</span> time <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`2018-09-17`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateBegin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> dateEnd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这一秒的时间 需重新设置</span>\ndateEnd<span class=\"token punctuation\">.</span><span class=\"token function\">setUTCHours</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置为世界时的0点 也就是北京时间八点</span>\n<span class=\"token comment\">// 计算时间差 参照上文</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div><!--beforeend--></div><!--afterend--></li>\n</ol>\n<p>以上：2018.09.21</p>\n</div>\n",null]}